<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1" />
		<title>AquaByte - Water Hub</title>
		<link
			href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css"
			rel="stylesheet" />
		<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
		<link rel="stylesheet" href="style.css" />
	</head>
	<body>
		<div id="spinnerOverlay">
			<div class="spinner-box">
				<div class="spinner-border text-primary" role="status">
					<span class="visually-hidden">Loading...</span>
				</div>
				<div>Contacting server…</div>
			</div>
		</div>

		<!-- Navbar -->
		<nav class="navbar navbar-expand-lg navbar-dark bg-primary shadow-sm">
			<div class="container">
				<a class="navbar-brand fw-bold" href="/">AquaBytes</a>
				<button
					class="navbar-toggler"
					data-bs-toggle="collapse"
					data-bs-target="#navMenu">
					<span class="navbar-toggler-icon"></span>
				</button>
				<div class="collapse navbar-collapse" id="navMenu">
					<ul class="navbar-nav ms-auto">
						<li class="nav-item">
							<a class="nav-link active" href="/tools/">Citizen Tool</a>
						</li>
						<li class="nav-item">
							<a class="nav-link" href="/stat/">Analytics</a>
						</li>
						<li class="nav-item">
							<a class="nav-link" href="/resource/">Resources</a>
						</li>
						<li class="nav-item">
							<a class="nav-link" href="/download/">Download</a>
						</li>
					</ul>
				</div>
			</div>
		</nav>

		<div class="container-lg mt-4">
			<div class="row g-4">
				<!-- Title -->
				<div class="col-12">
					<h3 class="mb-1" style="color: var(--primary-blue)">
						Water HUB - Predict Risk
					</h3>
					<div class="small-muted">
						Predict RISK with Machine Learning and IoT
					</div>
				</div>

				<!-- Form & Tabs -->
				<div class="col-lg-5">
					<div class="card p-3">
						<ul class="nav nav-tabs mb-3">
							<li class="nav-item">
								<button
									class="nav-link active"
									data-bs-toggle="tab"
									data-bs-target="#predictTab">
									Manual Data Entry
								</button>
							</li>
							<li class="nav-item">
								<button
									class="nav-link"
									data-bs-toggle="tab"
									data-bs-target="#sensorTab">
									Live Sensor
								</button>
							</li>
						</ul>

						<div class="tab-content">
							<!-- Predict Tab -->
							<div class="tab-pane fade show active" id="predictTab">
								<form id="waterForm" novalidate>
									<div class="row g-2 mb-3">
										<div class="col-6">
											<label class="form-label">State</label>
											<select id="state" class="form-select" required>
												<option value="">Select State</option>
											</select>
										</div>
										<div class="col-6">
											<label class="form-label">City</label>
											<select id="city" class="form-select" required>
												<option value="">Select City</option>
											</select>
										</div>
									</div>

									<div class="mb-3">
										<label class="form-label">Water Source</label>
										<select id="water_source" class="form-select" required>
											<option value="">Select Source</option>
											<option value="rainwater">Rainwater</option>
											<option value="tapwater">Tap Water</option>
											<option value="surfacewater">Surface Water</option>
											<option value="groundwater">Ground Water</option>
										</select>
									</div>

									<div class="row g-2 mb-2">
										<div class="col-6">
											<label class="form-label">Tank Capacity (L)</label>
											<input
												type="number"
												min="0"
												step="100"
												class="form-control"
												id="tank_cap"
												required />
										</div>
										<div class="col-6">
											<label class="form-label">Current Level (L)</label>
											<input
												type="number"
												min="0"
												step="100"
												class="form-control"
												id="current_level"
												required />
										</div>
									</div>

									<div class="row g-2 mb-2">
										<div class="col-6">
											<label class="form-label">Population</label>
											<input
												type="number"
												min="1"
												step="1"
												class="form-control"
												id="population"
												required />
										</div>
									</div>

									<div class="d-flex gap-2 align-items-center mt-3">
										<button
											id="submitBtn"
											type="submit"
											class="btn btn-primary">
											Calculate
										</button>
										<button
											id="resetBtn"
											type="button"
											class="btn btn-outline-primary">
											Reset
										</button>
										<div id="formMsg" class="small-muted ms-2"></div>
									</div>
								</form>
							</div>

							<!-- Live Sensor Tab -->
							<div class="tab-pane fade" id="sensorTab">
								<div class="row g-2 mb-3">
									<div class="col-6">
										<label class="form-label">State</label>
										<select id="state_live" class="form-select">
											<option value="">Select State</option>
										</select>
									</div>
									<div class="col-6">
										<label class="form-label">City</label>
										<select id="city_live" class="form-select">
											<option value="">Select City</option>
										</select>
									</div>
								</div>

								<div class="mb-3">
									<label class="form-label">Water Source</label>
									<select id="water_source_live" class="form-select">
										<option value="">Select Source</option>
										<option value="rainwater">Rainwater</option>
										<option value="tapwater">Tap Water</option>
										<option value="surfacewater">Surface Water</option>
										<option value="groundwater">Ground Water</option>
									</select>
								</div>

								<div class="text-center py-5">
									<div
										class="spinner-border text-primary mb-3"
										style="width: 3rem; height: 3rem"
										role="status"></div>
									<div class="fw-semibold">Connecting to sensors…</div>
								</div>
							</div>
						</div>
					</div>
				</div>

				<!-- Result Section -->
				<div class="col-lg-7">
					<div class="card result-card">
						<div class="big-display" id="bigDisplay">— days left</div>
						<div class="metrics">
							<div class="metric">
								<div class="label">pH</div>
								<div class="value" id="phVal">-</div>
							</div>
							<div class="metric">
								<div class="label">TDS</div>
								<div class="value" id="tdsVal">-</div>
							</div>
							<div class="metric">
								<div class="label">Storage Risk</div>
								<div class="value" id="storageRisk">-</div>
							</div>
							<div class="metric">
								<div class="label">Quality Risk</div>
								<div class="value" id="qualityRisk">-</div>
							</div>
						</div>
						<div class="chart-wrapper">
							<canvas id="rainChart"></canvas>
						</div>
						<div class="mt-3">
							<strong>Overall Suggestion:</strong>
							<div id="overallSuggestion" class="fw-semibold mb-2">-</div>
							<strong>Top Tips:</strong>
							<ul id="tipsList" class="tips mb-0 ps-3"></ul>
						</div>
					</div>
				</div>

				<!-- Footer -->
				<div class="col-12">
					<footer class="text-center py-3">
						<small>&copy; 2025 Universal Rainwater Harvesting Portal</small>
					</footer>
				</div>
			</div>
		</div>

		<script src="script.js"></script>
		<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
	</body>
</html>
