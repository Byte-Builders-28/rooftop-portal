<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8" />
		<title>RTRWH Portal - Citizen Tool</title>
		<meta name="viewport" content="width=device-width, initial-scale=1" />
		<link
			href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css"
			rel="stylesheet" />
		<link
			rel="stylesheet"
			href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
		<style>
			#mapContainer {
				display: none;
				margin-top: 15px;
			}
			#map {
				height: 400px;
				width: 100%;
				border-radius: 8px;
			}
			#spinnerOverlay {
				position: fixed;
				top: 0;
				left: 0;
				width: 100%;
				height: 100%;
				background: rgba(255, 255, 255, 0.8);
				display: flex;
				justify-content: center;
				align-items: center;
				z-index: 2000;
			}
		</style>
		<link rel="stylesheet" href="style.css" />
	</head>
	<body>
		<div id="spinnerOverlay">
			<div
				class="spinner-border text-primary"
				role="status"
				style="width: 4rem; height: 4rem">
				<span class="visually-hidden">Loading...</span>
			</div>
		</div>

		<nav class="navbar navbar-expand-lg navbar-dark bg-primary shadow-sm">
			<div class="container">
				<a class="navbar-brand fw-bold" href="../">AquaBytes</a>
				<button
					class="navbar-toggler"
					data-bs-toggle="collapse"
					data-bs-target="#navMenu">
					<span class="navbar-toggler-icon"></span>
				</button>
				<div class="collapse navbar-collapse" id="navMenu">
					<ul class="navbar-nav ms-auto">
						<li class="nav-item">
							<a class="nav-link active" href="#">Citizen Tool</a>
						</li>
						<li class="nav-item">
							<a class="nav-link" href="../stat/">Analytics</a>
						</li>
						<li class="nav-item">
							<a class="nav-link" href="../resource/">Resources</a>
						</li>
					</ul>
				</div>
			</div>
		</nav>

		<section class="py-5 container">
			<div class="card shadow-sm p-4">
				<div class="card-body">
					<h2 class="mb-4 text-center">Citizen Feasibility Check</h2>
					<form id="feasibilityForm" class="row g-3">
						<div class="col-md-6">
							<label class="form-label">State *</label>
							<select id="state" name="state" class="form-select" required>
								<option value="">Select State</option>
							</select>
						</div>
						<div class="col-md-6">
							<label class="form-label">City *</label>
							<select id="city" name="city" class="form-select" required>
								<option value="">Select City</option>
							</select>
						</div>

						<div class="col-md-6">
							<label class="form-label">Open Space (m²) *</label>
							<div class="input-group">
								<input
									type="number"
									class="form-control"
									name="openSpace"
									id="openSpace"
									step="0.01"
									required />
								<button
									class="btn btn-outline-secondary"
									type="button"
									id="useMapBtn">
									Use Map
								</button>
							</div>
						</div>

						<div class="col-12" id="mapContainer">
							<div class="mt-2">
								<button
									type="button"
									class="btn btn-sm btn-primary"
									id="locateBtn">
									Recenter (locate me)
								</button>
								<button
									type="button"
									class="btn btn-sm btn-success"
									id="finishBtn">
									Finish polygon
								</button>
								<button
									type="button"
									class="btn btn-sm btn-danger"
									id="clearBtn">
									Clear
								</button>
							</div>
							<div id="map"></div>
							<div class="mt-2 text-muted small" id="status">
								Click on the map to add polygon vertices.
							</div>
						</div>

						<div class="col-md-6">
							<label class="form-label">Number of Dwellers *</label>
							<input
								type="number"
								class="form-control"
								name="dwellers"
								required />
						</div>
						<div class="col-md-6">
							<label class="form-label">Roof Type *</label>
							<select id="roof" name="roof" class="form-select" required>
								<option value="">Select Roof Type</option>
								<option>Concrete (RCC)</option>
								<option>Cement Tiles</option>
								<option>Clay Tiles</option>
								<option>Metal Sheet</option>
								<option>GI Sheet</option>
								<option>Asbestos Sheet</option>
								<option>Slate</option>
								<option>Stone Slab</option>
								<option>Corrugated Sheet</option>
								<option>Thatched</option>
								<option>Plastic Sheet / PVC</option>
								<option>Glass</option>
								<option>Green Roof (vegetated)</option>
								<option>Other</option>
							</select>
						</div>
						<div class="col-md-6">
							<label class="form-label">Budget (Optional)</label>
							<input
								type="number"
								class="form-control"
								name="budget"
								step="0.01"
								placeholder="₹" />
						</div>
						<div class="col-12 text-center">
							<button type="submit" class="btn btn-primary btn-lg mt-3">
								Calculate
							</button>
						</div>
					</form>
					<div id="result" class="mt-4 text-center"></div>
				</div>
			</div>
		</section>

		<footer class="text-center py-3">
			<small>&copy; 2025 Universal Rainwater Harvesting Portal</small>
		</footer>

		<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
		<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
		<script src="https://cdn.jsdelivr.net/npm/@turf/turf@6.5.0/turf.min.js"></script>
		<script src="map.js"></script>
		<script src="script.js"></script>
		<script>
			// remove spinner after page loads
			window.addEventListener("load", () => {
				document.getElementById("spinnerOverlay").style.display = "none";
			});
		</script>
	</body>
</html>
